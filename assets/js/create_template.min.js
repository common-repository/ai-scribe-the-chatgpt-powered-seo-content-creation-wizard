const myObj={};jQuery(document).ready(function(){jQuery(".keywords").on("keydown",function(e){13===e.keyCode&&(jQuery(this).next(".tab_generate_btn").click(),e.preventDefault())}),jQuery("#lang, #writingStyle, #writingTone").on("change",function(){var e=ai_scribe.ajaxUrl,t=jQuery("#lang").val(),a=jQuery("#writingStyle").val(),n=jQuery("#writingTone").val();jQuery.ajax({type:"POST",url:e,dataType:"json",data:{action:"update_style_tone",writing_style:a,writing_tone:n,language:t},success:function(e){alert("Updated successfully")},error:function(){alert("Error saving style and tone")}})}),0==ai_scribe.apiKey.length&&(alert("Please add your API key within the settings page. If you don't have an OpenAI account yet, you can sign up for one here: https://beta.openai.com/signup"),window.location=ai_scribe.settingsUrl),ai_scribe.checkArr.addQNA||(jQuery("#conclusionCont").attr("data-nextstep","9"),jQuery("#conclusionSkip").attr("data-nextstep","9"),jQuery("#metadataBack").attr("data-nextstep","7")),jQuery(window).load(function(){var e,t=jQuery(".active_step").attr("data-step");p(jQuery(".at_temp_sec_"+t).addClass("active_page"))}),u();var e=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:" "}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]],t=new Quill(".editorjs",{modules:{toolbar:e},placeholder:"Compose an epic...",theme:"snow"});window.alok=t;let a=alok.clipboard.convert('<div class="ul1"></div>');alok.setContents(a);var n=new Quill(".editorjs2",{modules:{toolbar:e},placeholder:"Compose an epic...",theme:"snow"});window.finalreview=n;let i=finalreview.clipboard.convert('<div class="main-div3 title_class"></div>');finalreview.setContents(i),jQuery(".generate_more_btn").attr("disabled",!0),jQuery(".tab_regenerate_btn").attr("disabled",!0),jQuery("body").on("click",".copy_button",function(){var e=jQuery(this).closest(".copycontent").find(".get_checked").val(),t=e.replace(e.match(/(\d+)/g),"").replace(".","").trim();navigator.clipboard.writeText(t),jQuery(this).val("Copied"),setTimeout(()=>{jQuery(".copy_button").val("Copy")},1e3)}),jQuery("body").on("click",".generate_title :checkbox",function(){jQuery(".generate_title input").removeAttr("checked"),jQuery(this).prop("checked",!0)}),jQuery("#keywordback").click(function(){jQuery('input[name="get_checked"]:checked').prop("checked",!1),t.root.innerHTML=""});let r;var l="",o="";function s(){let e=document.querySelector(".editorjs2 .ql-editor");if(!e||!(e instanceof HTMLElement)){console.error("Article element not found. Please check the selector.");return}r=e.innerHTML;let t='<h2>Table of Contents</h2><ul class="toc">',a=2,n=e.querySelectorAll("h2, h3, h4, h5");for(n.forEach((e,n)=>{let i=parseInt(e.tagName.slice(1));for(;a<i;)t+='<ul class="toc">',a++;for(;a>i;)t+="</ul>",a--;t+=`<li><a href="#heading-${n}">${e.textContent}</a></li>`,e.id=`heading-${n}`});a>2;)t+="</ul>",a--;t+="</ul>";let i=e.querySelector("h2");if(i){finalreview.getLength(),finalreview.getText().length,finalreview.getText().indexOf(i.textContent);let l=finalreview.clipboard.convert(t);finalreview.setContents(l)}else console.error("First H2 element not found. Please check the content.")}function c(e){let t=["start-output","end-output"],a=e.replace(/"/g,""),n=a.split(/,\s*/),i=n.filter(e=>{let a=e.toLowerCase().trim();return!t.includes(a)});return i.map(e=>`"${e}"`).join(", ")}function d(e,t){var a=e.filter(function(e){return e.name===t});return a.length>0?a[0].value:""}function p(e){var t=v(),a=e.closest(".maincontent").find(".action_val_field").val(),n=null!=a?'"'+a+'"':" ";n=n.replace(/^([\d\W]\.\s*)/,"");var i=t.qna.join(",").replace(/,/g,"").split(),s=t.conclusion.join(",").replace(/,/g,"").split(),c=t.keyword.join('", "').replace(/[^\w\s,.]/gi,""),p='"'+t.tagline.join('", "')+'"',g=t.heading.join('", "');t.intro.join('", "');var h="";jQuery("input[name='checkArr[]']").map(function(){return jQuery(this).val()}).get();var u=jQuery("form").serializeArray(),m=jQuery(".above_below:checked").val(),f=e.attr("skip-btn");h="skip"==f?e.attr("data-nextstep"):jQuery(".temp-progress-bar .active_step").attr("data-step");var b=ai_scribe.promptsData,k=ai_scribe.aiEngine,y=ai_scribe.checkArr,w="";if(1==h?(w=b.title_prompts,jQuery(".checked-settings input:checked").each(function(){"addinsertToc"==(o=jQuery(this).val())&&(l=jQuery(this).val())})):2==h?(u[5].value.length,w=b.Keywords_prompts):3==h?(w=b.outline_prompts,k.model.includes("gpt-4")&&(w=w.replaceAll("and any relevant sub-sections","and no sub-sections"))):4==h?w=b.intro_prompts:5==h?w=b.tagline_prompts:6==h?(w=b.article_prompts,"skip"==f&&6==h&&(w=(w=(w=w.replaceAll("Add a tagline called","")).replaceAll("[above/below].","")).replaceAll("[The Tagline]",""))):7==h?w=b.conclusion_prompts:8==h?w=b.qa_prompts:9==h&&(w=b.meta_prompts),10==h){var $=jQuery(".ql-editor").html();w=$+s+i+"\n\n"+b.review_prompts}else if(11==h){if(void 0!==r){var $=r;w=$+"\n\n"+b.evaluate_prompts}else{var $=jQuery(".ql-editor").html();w=$+s+i+"\n\n"+b.evaluate_prompts}y.addsubMatter&&(w+="Have any authorities on the subject matter been included in the text? If not, list people who could be added."),y.addimgCont&&(w+="\nHave any IMG tags been added within the HTML? If not, list the kinds of image and video content that would complement the article, Also, give examples of suitable royalty-free sites where to find them."),y.addfurtheReading&&(w+="\nHas a section for further reading been included in the text? If not, list related topics that could be added."),y.addinsertHyper&&(w+="\nHave any A tags been added within the HTML? If not, list relevant phrases within the article where hyperlinks could be added? Suggest potential domains for these hyperlinks."),y.addkeywordBold&&(w+="\nHave any STRONG tags been added within the HTML? If not, list important phrases within the article where bold tags could be added"),"addkeywordBold"==o&&(w+="\nHave any STRONG tags been added within the HTML? If not, list important phrases within the article where bold tags could be added")}var C=d(u,"languages"),T=d(u,"writingStyle"),A=d(u,"writingTone"),x=d(u,"headingtag"),_=d(u,"num_heading"),j=d(u,"keyword_avoid");w=(w=(w=(w=w.replaceAll("[Language]",C)).replaceAll("[Style]",T)).replaceAll("[Tone]",A)).replaceAll("[Heading Tag]",x);var H=n.replace(/['"]+/g,"");void 0!==(H=H.trim())&&""!=H&&(w=w.replaceAll("[Idea]",H));var S=t.title;if(void 0!==S&&""!=S&&(w=w.replaceAll("[Title]",S)),""!=j&&11!=h&&9!=h){var I=(j=j.split(",")).join('", "');w=w+" Exclude the following keywords "+(I='"'+I+'"')+" if they have been provided. "}if(""!=_&&(w=w.replaceAll("[No. Headings]",_)),"skip"==f&&3==h&&(w=w.replaceAll("and [Selected Keywords].","")),""!==c){for(var L=c.split(","),q=0;q<L.length;q++)L[q]='"'+L[q].trim()+'"';var D="following SEO keywords "+L.join(" and ");w=w.replaceAll("[Selected Keywords]",D)}else w=(w=(w=(w=(w=(w=w.replaceAll("Please include the following SEO keywords [Selected Keywords] where appropriate in the headings.","")).replaceAll("and the [Selected Keywords]","")).replaceAll("SEO optimise the content for the [Selected Keywords].","")).replaceAll("and optimise for the [Selected Keywords]","")).replaceAll("[Keywords Bold].","")).replaceAll("and the [Selected Keywords]","");""!=m&&(w=w.replaceAll("[above/below]",m)),""!=x&&(w=w.replaceAll("[Heading Tag]",x)),""!=g&&(w=w.replaceAll("[Heading]",g));var M=t.intro;if(w=""!=M?w.replaceAll("[Intro]",M):(w=w.replaceAll("The following introduction should be at the top: ","")).replaceAll("[Intro]",""),""!=p){var P="add the tagline "+p;""!=m&&(P+=" "+m),P+=" the introduction in a new P tag formatted in bold",w=w.replaceAll("[The Tagline]",P)}return w=w.replaceAll("\\",""),myObj[h]=w,jQuery("#prompt_text").val(w),jQuery("#prompt_text").each(function(){}),w}function g(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}function h(e){var t=v(),a=jQuery(".temp-progress-bar .active_step").attr("data-step"),n=jQuery("#prompt_text").val(),i=e.attr("auto-generate"),r=e.attr("generate-more"),l=e.attr("prompt-regenerate"),o=jQuery(".at_temp_sec.active_page").find(".tab_generate_btn").attr("data-action"),s=e.attr("skip-btn"),c=ai_scribe.ajaxUrl;"cont_next_step"==i&&(n=p(e)),"skip"==s&&(o=jQuery(".at_temp_sec.active-skip").find(".tab_generate_btn").attr("data-action"));var d=jQuery("form").serializeArray(),h=jQuery("#tab_input").val(),t=v(),u=null!=t.title?t.title:"",m=t.keyword.join(","),k=t.tagline.join(","),y=jQuery(".above_below:checked").val();jQuery.ajax({type:"post",url:c,dataType:"json",data:{action:"al_scribe_suggest_content",autogenerateValue:n,actionInput:o,idea:h,title:u,keyword:m,tagline:k,aboveBelow:y,language:d[0].value,writingStyle:d[1].value,writingTone:d[2].value,noHeading:d[3].value,headingTag:d[4].value,keywordToAvoid:d[5].value},beforeSend:function(){jQuery(".progress-container").css("display","block"),jQuery(".article-main").addClass("article_progress"),f(),b(),jQuery("button").attr("disabled",!0)},success:function(e){if("error"==e.type)return alert(e.message),!1;if("currentpage"==l||6==a){var t=alok.clipboard.convert(g(e.html));alok.setContents(t,"silent")}else if(s&&5==a){var t=alok.clipboard.convert(g(e.html));alok.setContents(t,"silent")}else if("currentpage"==l||10==a){var t=finalreview.clipboard.convert(g(e.html));finalreview.setContents(t,"silent")}else"generate_more"==r?jQuery(".at_temp_sec.active_page .title_class").append(e.html):jQuery(".at_temp_sec.active_page .title_class").html(g(e.html));jQuery(".prompts-options").show()},error:function(e,t,a){console.log("AJAX Error:",t,e.status,a);var n="An error occurred: ";"timeout"===t?n+="The request timed out. Please check your internet connection and try again.":500===e.status?n+="There was a server error. Please try again later.":404===e.status?n+="The requested resource could not be found. Please contact support.":n+="Please check your internet connection and try again.",alert(n)},complete:function(e){jQuery(".progress-container").css("display","none"),jQuery(".article-main").removeClass("article_progress"),setTimeout(()=>{jQuery("button").removeAttr("disabled"),b()},2e3)}})}function v(){var e=jQuery(".generate_title :checked").val(),e=e,t=[];jQuery(".generate_heading .get_checked:checked").each(function(e){t[e]=jQuery(this).val(),t[e]=t[e]?.replace(t[e]?.match(/(\d+)./g),"").trim(),t[e]=t[e]?.split(/<\/?br\s*\/?>/).filter(Boolean).map(e=>`"${e.trim()}"`).join(", ")});var a=[];jQuery(".generate_keyword .get_checked:checked").each(function(e){a[e]=jQuery(this).val(),a[e]=a[e]?.replace(a[e]?.match(/(\d+)./g),"").trim()});var n=[];jQuery(".generate_intro .get_checked:checked").each(function(e){n[e]=jQuery(this).val(),n[e]=n[e]?.replace(n[e]?.match(/(\d+)./g),"").trim()});var i=[];jQuery(".generate_tagline .get_checked:checked").each(function(e){i[e]=jQuery(this).val(),i[e]=i[e]?.replace(i[e]?.match(/(\d+)./g),"").trim()});var r=[];jQuery(".generate_conclusion .get_checked:checked").each(function(e){r[e]=jQuery(this).val(),r[e]=r[e]?.replace(r[e]?.match(/(\d+)./g),"").trim()});var l=[];jQuery(".generate_qna .get_checked:checked").each(function(e){l[e]=jQuery(this).val(),l[e]=l[e]?.replace(l[e]?.match(/(\d+)./g),"").trim()});var o=[];return jQuery(".generate_seo-meta-data .get_checked:checked").each(function(e){o[e]=jQuery(this).val(),o[e]=o[e]?.replace(o[e]?.match(/(\d+)./g),"").trim()}),{title:e,heading:t,keyword:a,intro:n,tagline:i,conclusion:r,qna:l,metadata:o}}function u(){var e=jQuery(".active_step").attr("data-step");jQuery(".lang-additional-heading"),10==e?jQuery("input[name='checkArr[]']").removeClass("inactive_field"):jQuery("input[name='checkArr[]']").addClass("inactive_field"),1==e||2==e||5==e||6==e||9==e?(jQuery("input[name='num_heading']").addClass("inactive_field"),jQuery("#heading-tag").addClass("inactive_field")):(jQuery("input[name='num_heading']").removeClass("inactive_field"),jQuery("#heading-tag").removeClass("inactive_field")),1==e||10==e?jQuery(".languages").removeClass("inactive_field"):jQuery(".languages").addClass("inactive_field"),4==e||7==e?jQuery(".no_heading").addClass("inactive_field"):jQuery(".no_heading").removeClass("inactive_field"),6==e||11==e?jQuery(".form1").addClass("inactive_field"):jQuery(".form1").removeClass("inactive_field")}jQuery(".action_val_field").on("input",function(){var e;p(jQuery(this))}),jQuery(".action_val_field").on("textarea",function(){var e;p(jQuery(this))}),jQuery(".lang-additional-heading").on("change",function(){jQuery("#tab_input").trigger("input")}),jQuery(".heading_key_avoid").on("input",function(){jQuery("#tab_input").trigger("input")}),jQuery(".next_step_btn").click(function(){var e=v(),a=jQuery(this);jQuery("textarea#prompt_text").val(),jQuery(".action_val_field").val();var n=jQuery(this).attr("data-nextstep"),i=jQuery(this).attr("back-btn"),r=jQuery(this).attr("skip-btn");jQuery(this).attr("auto-generate");var o=jQuery(this).closest(".maincontent").find(".tab_generate_btn").attr("data-action"),c=jQuery(this).closest(".maincontent").find(".after_generate_data"),d=jQuery(this).closest(".maincontent").find(".get_checked:checked"),g=jQuery(".temp-progress-bar .active_step").attr("data-step");if(a.closest(".maincontent").find(".action_val_field").val(),jQuery(`#step${jQuery(".active_step").attr("data-step")}`),i)jQuery("textarea#prompt_text").val(myObj[n]),dataS=jQuery(".active_step").attr("data-step"),"11"!==g&&jQuery(".prompts-sec").show(),jQuery(`[data-step='${rem=dataS-1}'] .rightCheck`).replaceWith("<i class='fa-solid fa-square-check fa-2xl'></i>");else if("skip"==r){p(a),jQuery(".at_temp_sec_"+n).addClass("active-skip");var m=jQuery(this).closest(".maincontent").find(".checked-element").html(),e=v(),f=t.root.innerHTML,b=e.qna.join(",").replace(/,/g,"").split(),k=e.conclusion.join(",").replace(/,/g,"").split(),y=k.length>0?k+"<br/><br/>":"",w=b.length>0?b+"<br/><br/>":"";if("9"!==g&&h(a),9==g){var $=finalreview.clipboard.convert(f+y+w);finalreview.setContents($,"silent"),"addinsertToc"==l&&setTimeout(()=>{s()},500)}else jQuery(".active-skip").find(".checked-element").html(m);jQuery(".at_temp_sec").removeClass("active-skip")}if(i||r){jQuery(".at_temp_sec").hide();var C=".at_temp_sec_"+n;return jQuery(".temp-progress-bar .step").removeClass("active_step"),jQuery(".at_temp_sec").removeClass("active_page"),jQuery('.temp-progress-bar div[data-step="'+n+'"]').addClass("active_step"),jQuery(".at_temp_sec_"+n).addClass("active_page"),jQuery(C).show(),u(),jQuery("html, body").animate({scrollTop:jQuery(".create_template_cont_sec").position().top}),!1}if(!i){if(0!=c.length||"7"===n||"11"===n){if(0!=d.length||"7"===n||"11"===n){jQuery(".progress-menu-bar .active_step .bullet").replaceWith("<i class='fa-solid fa-square-check fa-2xl'></i>"),jQuery(".at_temp_sec").hide();var C=".at_temp_sec_"+n;jQuery(".temp-progress-bar .step").removeClass("active_step"),jQuery(".at_temp_sec").removeClass("active_page"),jQuery('.temp-progress-bar div[data-step="'+n+'"]').addClass("active_step"),jQuery(".at_temp_sec_"+n).addClass("active_page"),jQuery(C).show(),u(),jQuery("html, body").animate({scrollTop:jQuery(".create_template_cont_sec").position().top});var a=jQuery(this);"9"!==g&&h(a),function e(){var a=v(),n=t.root.innerHTML;jQuery(".editorjs").innerHTML;var i=a.qna.join(",").replace(/,/g,"").split(),r=a.conclusion.join(",").replace(/,/g,"").split(),l=jQuery(`#step${jQuery(".active_step").attr("data-step")}`),o=jQuery(".temp-progress-bar .active_step").attr("data-step"),s=a.keyword.join("<br/>"),c=a.title.length>0?"<b> Title </b>  :- "+a.title+"<br/><br/>":"",d=a.keyword.length>0?"<b> Keyword </b> :- "+s+"<br/><br/>":"",p=a.heading.length>0?"<b> Heading </b> :- "+a.heading+"<br/><br/>":"",g=a.intro.length>0?"<b> Intro </b> :- "+a.intro+"<br/><br/>":"",h=a.tagline.length>0?"<b> Tagline </b> :- "+a.tagline+"<br/><br/>":"",u=r.length>0?r+"<br/><br/>":"",m=i.length>0?i+"<br/><br/>":"",f=a.metadata.length>0?"<b> Meta Data </b>:- "+a.metadata:"",b=jQuery(".above_below:checked").val(),k=jQuery(".above_below_conclusion:checked").val(),y=c+d+p+g+h+n+u+m+f;10==o&&(y=n+u+m,y="above"==k||"above"==b?n+m+u:n+u+m);var w=l.find(".checked-element");if(10==o){var $=finalreview.clipboard.convert(y);finalreview.setContents($,"silent")}var C=document.createElement("ul");C.innerHTML='<li style="margin-bottom: 6px; margin-top: 6px; margin-left: 3px;">'+y+"</li>";var w=l.find(".checked-element");return w.html(C),w.html('<ul><li style=" margin-bottom: 6px;  margin-top: 6px; margin-left: 3px;">'+y+"</li></ul>")}(),a.closest(".maincontent").find(".action_val_field").val();var g=jQuery(".temp-progress-bar .active_step").attr("data-step");p(a),setTimeout(()=>{jQuery(".at_temp_sec_"+n)},100)}else alert("Please select a checkbox before continuing"),p(a)}else alert("Please select a "+o+" before continuing."),p(a)}"10"==g&&"addinsertToc"==l&&setTimeout(()=>{s()},500)}),jQuery(".tab_generate_btn").click(function(){var e;if(""==jQuery(this).closest(".title_div").find(".action_val_field").val()){alert("Please enter a value before clicking the continue button");return}h(jQuery(this)),jQuery(".generate_more_btn").removeAttr("disabled"),jQuery(".tab_regenerate_btn").removeAttr("disabled")}),jQuery(".tab_regenerate_btn").click(function(){var e=jQuery(`#step${jQuery(".active_step").attr("data-step")}`),t=jQuery(".temp-progress-bar .active_step").attr("data-step");if(""==e.find(".action_val_field").val()&&1==t){alert("Please Enter Input");return}return h(e),!1}),jQuery(".generate_more_btn").click(function(){var e=jQuery(this),t=jQuery(".temp-progress-bar .active_step").attr("data-step");if(""==e.closest(".maincontent").find(".action_val_field").val()&&1==t){alert("Please Enter Input");return}return h(e),!1}),jQuery(".save_post_tab").click(function(){var e=v(),t=ai_scribe.ajaxUrl,a=jQuery(".checked_value").val(),i=n.root.innerHTML;f(),jQuery.ajax({type:"post",url:t,dataType:"json",data:{action:"al_scribe_send_post_page",titleData:e.title,headingData:e.heading,keywordData:e.keyword,introData:e.intro,taglineData:e.tagline,articleVal:i,conclusionData:e.conclusion,qnaData:e.qna,metaData:e.metadata,contentData:a},beforeSend:function(){jQuery(".article-main").addClass("overlay")},success:function(e){console.log(e),alert("Post saved successfully!")},complete:function(e){jQuery(".article-main").removeClass("overlay")}})}),jQuery(".save_as_shortcode").click(function(){var e=ai_scribe.ajaxUrl,t=v(),a=n.root.innerHTML;f(),jQuery.ajax({type:"post",dataType:"json",url:e,data:{action:"al_scribe_send_shortcode_page",titleData:t.title,headingData:t.heading,keywordData:t.keyword,introData:t.intro,taglineData:t.tagline,articleVal:a,conclusionData:t.conclusion,qnaData:t.qna,metaData:t.metadata},beforeSend:function(){jQuery(".article-main").addClass("overlay")},success:function(e){console.log(e),alert("Post saved successfully!")},complete:function(e){jQuery(".article-main").removeClass("overlay")}})}),jQuery(".languages_style_tab").click(function(){var e=jQuery(this);jQuery(".languages_style").toggle(),e.toggleClass("expanded"),e.hasClass("expanded")?e.html("-"):e.html("+")}),jQuery(".heading_tab").click(function(){var e=jQuery(this);jQuery(".hide_headings_tab").toggle(),e.toggleClass("expanded"),e.hasClass("expanded")?e.html("-"):e.html("+")}),jQuery(".additional_content_tab").click(function(){var e=jQuery(this);jQuery(".hide_addition_content").toggle(),e.toggleClass("expanded"),e.hasClass("expanded")?e.html("-"):e.html("+")}),jQuery(".show_prompt").click(function(){jQuery(".prompts-options").toggle(),jQuery(".regen").toggle(),jQuery(this).val("Show"==jQuery(this).val()?"Hide":"Show")});var m=0;function f(){if(0==m){m=1;var e=document.getElementById("progressBar"),t=10,a=setInterval(function n(){t>=100?(clearInterval(a),m=0,e.innerHTML="WAIT (STILL LOADING)...",e.style.animation="buzzing 0.2s linear infinite"):(t++,e.style.width=t+"%",e.innerHTML=t+"%")},200)}}function b(){var e=document.getElementById("progressBar");e.style.width="0%",e.innerHTML="0%",e.style.animation="none"}});